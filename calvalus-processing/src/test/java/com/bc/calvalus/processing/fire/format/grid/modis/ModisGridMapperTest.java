package com.bc.calvalus.processing.fire.format.grid.modis;

import com.bc.calvalus.processing.fire.format.grid.GridCells;
import org.esa.snap.core.dataio.ProductIO;
import org.esa.snap.core.datamodel.Product;
import org.junit.Ignore;
import org.junit.Test;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FilenameFilter;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;

import static org.junit.Assert.assertArrayEquals;
import static org.junit.Assert.assertEquals;

public class ModisGridMapperTest {

    @Ignore
    @Test
    public void acceptanceTestComputeGridCell() throws Exception {
        ModisGridMapper mapper = new ModisGridMapper();
        Product product = ProductIO.readProduct("D:\\workspace\\fire-cci\\temp\\BA_PIX_MER_v04h24_200806_v4.0.tif");
        Product lcProduct = ProductIO.readProduct("D:\\workspace\\fire-cci\\temp\\lc-2005-v04h24.nc");
        File[] srFiles = new File("D:\\workspace\\fire-cci\\temp").listFiles(new FilenameFilter() {
            @Override
            public boolean accept(File dir, String name) {
                return name.contains("CCI-Fire-MERIS-SDR-");
            }
        });
        List<File> srProducts = new ArrayList<>();
        Collections.addAll(srProducts, srFiles);

//        mapper.setDataSource(new ModisFireGridDataSource("", product, lcProduct, srProducts));
        GridCells gridCells = mapper.computeGridCells(2008, 1);
        System.out.println(gridCells);
    }

    @Test
    public void name() {
        double[] doubles = {0.0, 0.0, 1.0, 2.0, 3.0, 4.0, 100.0, 100.0, 100.0, 100.0, -1, -1, -1};
        assertEquals(19332.52734375, new ModisGridMapper().getErrorPerPixel(doubles, 0, 0), 1E-7);
    }

    @Test
    public void name2() {
//        23040000
//        23037152
//        282
        double[] doubles = {1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 3.0, 2.0, 2.0, 1.0, 1.0, 1.0, 3.0, 6.0, 3.0, 2.0, 4.0, 1.0, 1.0, 2.0, 2.0, 2.0, 2.0, 7.0, 1.0, 3.0, 2.0, 2.0, 2.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 3.0, 1.0, 1.0, 26.0, 1.0, 1.0, 2.0, 8.0, 1.0, 1.0, 1.0, 18.0, 4.0, 5.0, 2.0, 2.0, 2.0, 3.0, 1.0, 2.0, 2.0, 8.0, 3.0, 12.0, 13.0, 1.0, 1.0, 1.0, 54.0, 8.0, 16.0, 17.0, 4.0, 6.0, 39.0, 1.0, 3.0, 9.0, 9.0, 28.0, 9.0, 10.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 11.0, 13.0, 23.0, 10.0, 9.0, 1.0, 4.0, 14.0, 5.0, 2.0, 1.0, 39.0, 43.0, 12.0, 54.0, 2.0, 7.0, 1.0, 3.0, 3.0, 3.0, 22.0, 11.0, 34.0, 10.0, 21.0, 9.0, 5.0, 3.0, 49.0, 53.0, 19.0, 25.0, 4.0, 4.0, 2.0, 2.0, 2.0, 1.0, 4.0, 2.0, 1.0, 22.0, 43.0, 15.0, 18.0, 7.0, 9.0, 11.0, 28.0, 16.0, 60.0, 40.0, 55.0, 27.0, 2.0, 20.0, 3.0, 1.0, 1.0, 1.0, 1.0, 4.0, 4.0, 7.0, 40.0, 22.0, 5.0, 7.0, 8.0, 2.0, 70.0, 22.0, 6.0, 38.0, 9.0, 23.0, 1.0, 2.0, 5.0, 48.0, 18.0, 1.0, 2.0, 26.0, 1.0, 1.0, 1.0, 1.0, 3.0, 3.0, 5.0, 1.0, 2.0, 19.0, 49.0, 5.0, 2.0, 1.0, 1.0, 16.0, 70.0, 23.0, 2.0, 1.0, 11.0, 2.0, 3.0, 18.0, 37.0, 3.0, 25.0, 99.0, 1.0, 1.0, 5.0, 5.0, 99.0, 1.0, 1.0, 6.0, 1.0, 4.0, 17.0, 14.0, 95.0, 1.0, 1.0, 2.0, 1.0, 52.0, 100.0, 97.0, 33.0, 18.0, 2.0, 5.0, 100.0, 100.0, 73.0, 90.0, 2.0, 2.0, 2.0, 12.0, 1.0, 1.0, 2.0, 100.0, 100.0, 99.0, 95.0, 96.0, 2.0, 2.0, 2.0, 17.0, 94.0, 100.0, 100.0, 100.0, 96.0, 1.0, 2.0, 2.0, 55.0, 13.0, 79.0, 90.0, 99.0, 99.0, 99.0, 95.0, 1.0, 11.0, 2.0, 1.0, 2.0, 2.0, 63.0, 67.0, 95.0, 75.0, 91.0, 100.0, 99.0, 99.0, 98.0, 25.0, 7.0, 6.0, 9.0, 2.0, 8.0, 81.0, 100.0, 100.0, 82.0, 99.0, 99.0, 99.0, 60.0, 65.0, 47.0, 45.0, 8.0, 1.0, 93.0, 26.0, 97.0, 100.0, 78.0, 99.0, 95.0, 100.0, 40.0, 38.0, 9.0, 22.0, 13.0, 3.0, 1.0, 1.0, 2.0, 1.0, 45.0, 64.0, 82.0, 99.0, 35.0, 99.0, 98.0, 95.0, 96.0, 98.0, 20.0, 1.0, 1.0, 1.0, 7.0, 8.0, 91.0, 20.0, 97.0, 41.0, 95.0, 97.0, 96.0, 83.0, 40.0, 3.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0, 18.0, 8.0, 2.0, 57.0, 59.0, 4.0, 1.0, 1.0, 1.0, 2.0, 36.0, 9.0, 24.0, 32.0, 82.0, 3.0, 9.0, 27.0, 76.0, 4.0, 3.0, 33.0, 19.0, 14.0, 23.0, 7.0, 5.0, 92.0, 1.0, 1.0, 1.0, 3.0, 14.0, 3.0, 98.0, 7.0, 7.0, 7.0, 7.0, 3.0, 27.0, 14.0, 3.0, 6.0, 20.0, 24.0, 5.0, 4.0, 1.0, 1.0, 1.0, 2.0, 8.0, 10.0, 3.0, 1.0, 72.0, 62.0, 1.0, 1.0, 2.0, 4.0, 3.0, 2.0, 4.0, 21.0, 7.0, 3.0, 1.0, 8.0, 19.0, 27.0, 19.0, 8.0, 3.0, 1.0, 1.0, 1.0, 1.0, 38.0, 79.0, 25.0, 79.0, 81.0, 82.0, 30.0, 18.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 3.0, 3.0, 8.0, 6.0, 27.0, 3.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 2.0, 3.0, 4.0, 2.0, 2.0, 6.0, 1.0, 1.0, 4.0, 4.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 11.0, 1.0, 6.0, 15.0, 1.0, 2.0, 1.0, 3.0, 1.0, 10.0, 1.0, 75.0, 70.0, 95.0, 95.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 4.0, 1.0, 2.0, 6.0, 3.0, 1.0, 1.0, 2.0, 12.0, 63.0, 92.0, 97.0, 95.0, 97.0, 89.0, 89.0, 58.0, 3.0, 2.0, 1.0, 1.0, 1.0, 1.0, 6.0, 1.0, 2.0, 1.0, 2.0, 1.0, 20.0, 4.0, 3.0, 16.0, 16.0, 69.0, 1.0, 1.0, 3.0, 5.0, 5.0, 5.0, 1.0, 17.0, 1.0, 2.0, 3.0, 20.0, 98.0, 82.0, 89.0, 60.0, 56.0, 4.0, 1.0, 1.0, 2.0, 5.0, 26.0, 6.0, 6.0, 28.0, 1.0, 34.0, 31.0, 30.0, 4.0, 5.0, 1.0, 1.0, 4.0, 4.0, 11.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 28.0, 7.0, 74.0, 11.0, 84.0, 98.0, 97.0, 1.0, 7.0, 8.0, 1.0, 3.0, 17.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0, 2.0, 2.0, 7.0, 6.0, 28.0, 31.0, 44.0, 9.0, 1.0, 2.0, 10.0, 1.0, 1.0, 2.0, 1.0, 1.0, 4.0, 3.0, 1.0, 1.0, 3.0, 29.0, 79.0, 86.0, 99.0, 99.0, 95.0, 97.0, 36.0, 28.0, 1.0, 47.0, 3.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 4.0, 13.0, 15.0, 15.0, 11.0, 13.0, 64.0, 82.0, 29.0, 98.0, 1.0, 3.0, 1.0, 3.0, 3.0, 5.0, 1.0, 16.0, 11.0, 73.0, 3.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 50.0, 96.0, 2.0, 99.0, 100.0, 3.0, 63.0, 1.0, 1.0, 5.0, 3.0, 1.0, 1.0, 1.0, 9.0, 1.0, 8.0, 17.0, 19.0, 33.0, 81.0, 9.0, 32.0, 1.0, 2.0, 1.0, 1.0, 3.0, 1.0, 4.0, 60.0, 30.0, 1.0, 1.0, 1.0, 1.0, 14.0, 12.0, 99.0, 93.0, 99.0, 99.0, 62.0, 78.0, 1.0, 7.0, 1.0, 4.0, 10.0, 4.0, 1.0, 9.0, 63.0, 77.0, 16.0, 8.0, 8.0, 61.0, 5.0, 13.0, 15.0, 3.0, 3.0, 7.0, 5.0, 1.0, 3.0, 1.0, 1.0, 33.0, 15.0, 5.0, 4.0, 97.0, 72.0, 85.0, 56.0, 8.0, 10.0, 2.0, 1.0, 1.0, 1.0, 4.0, 15.0, 6.0, 7.0, 6.0, 57.0, 9.0, 2.0, 28.0, 11.0, 18.0, 38.0, 30.0, 14.0, 62.0, 64.0, 92.0, 29.0, 4.0, 6.0, 5.0, 6.0, 7.0, 2.0, 1.0, 3.0, 2.0, 3.0, 3.0, 7.0, 47.0, 9.0, 11.0, 74.0, 98.0, 97.0, 94.0, 20.0, 29.0, 69.0, 3.0, 1.0, 1.0, 1.0, 2.0, 17.0, 1.0, 1.0, 8.0, 10.0, 1.0, 19.0, 27.0, 33.0, 56.0, 65.0, 41.0, 76.0, 37.0, 26.0, 20.0, 73.0, 96.0, 35.0, 76.0, 99.0, 97.0, 100.0, 97.0, 98.0, 98.0, 26.0, 36.0, 1.0, 13.0, 11.0, 1.0, 1.0, 1.0, 80.0, 23.0, 4.0, 73.0, 4.0, 26.0, 3.0, 2.0, 21.0, 41.0, 84.0, 56.0, 47.0, 48.0, 46.0, 38.0, 66.0, 40.0, 27.0, 37.0, 75.0, 57.0, 19.0, 86.0, 99.0, 100.0, 99.0, 99.0, 26.0, 93.0, 1.0, 5.0, 2.0, 1.0, 2.0, 2.0, 3.0, 12.0, 22.0, 16.0, 47.0, 18.0, 4.0, 1.0, 3.0, 90.0, 96.0, 70.0, 80.0, 67.0, 62.0, 70.0, 86.0, 70.0, 48.0, 44.0, 50.0, 52.0, 6.0, 88.0, 96.0, 100.0, 100.0, 100.0, 100.0, 80.0, 41.0, 51.0, 53.0, 54.0, 32.0, 1.0, 2.0, 68.0, 1.0, 2.0, 1.0, 1.0, 3.0, 30.0, 89.0, 64.0, 31.0, 15.0, 35.0, 80.0, 41.0, 49.0, 33.0, 30.0, 66.0, 47.0, 58.0, 57.0, 49.0, 62.0, 80.0, 15.0, 55.0, 23.0, 33.0, 100.0, 100.0, 100.0, 100.0, 85.0, 91.0, 73.0, 82.0, 100.0, 88.0, 73.0, 24.0, 1.0, 1.0, 4.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 6.0, 6.0, 11.0, 77.0, 47.0, 58.0, 2.0, 2.0, 34.0, 3.0, 20.0, 32.0, 31.0, 16.0, 14.0, 82.0, 36.0, 44.0, 72.0, 93.0, 100.0, 99.0, 100.0, 100.0, 100.0, 100.0, 100.0, 97.0, 97.0, 84.0, 92.0, 66.0, 46.0, 15.0, 31.0, 10.0, 5.0, 20.0, 7.0, 9.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0, 98.0, 87.0, 78.0, 82.0, 4.0, 6.0, 4.0, 11.0, 17.0, 28.0, 10.0, 19.0, 93.0, 84.0, 68.0, 82.0, 100.0, 99.0, 99.0, 98.0, 100.0, 100.0, 100.0, 100.0, 99.0, 99.0, 91.0, 97.0, 98.0, 99.0, 97.0, 22.0, 100.0, 99.0, 91.0, 41.0, 1.0, 11.0, 6.0, 46.0, 52.0, 99.0, 9.0, 11.0, 14.0, 1.0, 1.0, 2.0, 3.0, 1.0, 2.0, 4.0, 1.0, 1.0, 4.0, 3.0, 3.0, 1.0, 97.0, 3.0, 22.0, 27.0, 45.0, 89.0, 85.0, 63.0, 64.0, 88.0, 79.0, 95.0, 100.0, 100.0, 100.0, 97.0, 99.0, 100.0, 100.0, 100.0, 100.0, 97.0, 96.0, 88.0, 76.0, 91.0, 37.0, 64.0, 100.0, 100.0, 100.0, 12.0, 3.0, 31.0, 2.0, 81.0, 94.0, 100.0, 70.0, 41.0, 1.0, 2.0, 3.0, 4.0, 3.0, 4.0, 6.0, 3.0, 1.0, 2.0, 24.0, 12.0, 60.0, 97.0, 86.0, 14.0, 4.0, 44.0, 98.0, 100.0, 100.0, 97.0, 99.0, 79.0, 81.0, 100.0, 100.0, 99.0, 100.0, 98.0, 98.0, 100.0, 100.0, 97.0, 100.0, 97.0, 95.0, 88.0, 86.0, 14.0, 77.0, 100.0, 100.0, 98.0, 96.0, 1.0, 9.0, 15.0, 96.0, 96.0, 95.0, 97.0, 97.0, 1.0, 1.0, 10.0, 1.0, 3.0, 2.0, 2.0, 4.0, 1.0, 1.0, 3.0, 1.0, 1.0, 83.0, 14.0, 62.0, 90.0, 92.0, 100.0, 99.0, 98.0, 99.0, 74.0, 25.0, 99.0, 61.0, 18.0, 97.0, 98.0, 97.0, 99.0, 100.0, 83.0, 100.0, 99.0, 100.0, 100.0, 100.0, 99.0, 53.0, 39.0, 34.0, 15.0, 1.0, 2.0, 2.0, 4.0, 1.0, 18.0, 98.0, 99.0, 100.0, 20.0, 99.0, 9.0, 14.0, 4.0, 1.0, 4.0, 3.0, 6.0, 3.0, 18.0, 55.0, 21.0, 2.0, 77.0, 3.0, 84.0, 93.0, 93.0, 100.0, 100.0, 98.0, 97.0, 90.0, 84.0, 99.0, 99.0, 98.0, 99.0, 93.0, 98.0, 98.0, 99.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 43.0, 21.0, 22.0, 19.0, 8.0, 62.0, 1.0, 1.0, 3.0, 2.0, 5.0, 4.0, 5.0, 96.0, 100.0, 100.0, 41.0, 100.0, 99.0, 11.0, 4.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 13.0, 1.0, 4.0, 8.0, 3.0, 8.0, 87.0, 17.0, 91.0, 85.0, 100.0, 100.0, 100.0, 100.0, 89.0, 74.0, 85.0, 99.0, 99.0, 97.0, 96.0, 97.0, 95.0, 98.0, 100.0, 100.0, 100.0, 100.0, 99.0, 38.0, 18.0, 15.0, 11.0, 1.0, 1.0, 12.0, 2.0, 14.0, 2.0, 86.0, 47.0, 97.0, 100.0, 100.0, 84.0, 3.0, 8.0, 24.0, 6.0, 9.0, 6.0, 2.0, 5.0, 10.0, 3.0, 3.0, 2.0, 5.0, 2.0, 29.0, 5.0, 35.0, 50.0, 12.0, 19.0, 40.0, 95.0, 76.0, 99.0, 100.0, 100.0, 100.0, 93.0, 88.0, 100.0, 99.0, 99.0, 99.0, 98.0, 96.0, 98.0, 99.0, 100.0, 100.0, 100.0, 100.0, 99.0, 5.0, 66.0, 27.0, 78.0, 72.0, 99.0, 12.0, 98.0, 87.0, 86.0, 61.0, 2.0, 1.0, 1.0, 1.0, 71.0, 93.0, 5.0, 73.0, 17.0, 18.0, 43.0, 57.0, 80.0, 1.0, 1.0, 24.0, 2.0, 5.0, 6.0, 51.0, 16.0, 22.0, 37.0, 89.0, 26.0, 13.0, 50.0, 78.0, 100.0, 54.0, 55.0, 97.0, 93.0, 87.0, 58.0, 43.0, 40.0, 75.0, 63.0, 29.0, 20.0, 11.0, 21.0, 47.0, 45.0, 63.0, 3.0, 100.0, 100.0, 100.0, 100.0, 1.0, 99.0, 100.0, 100.0, 99.0, 94.0, 95.0, 96.0, 47.0, 36.0, 51.0, 1.0, 13.0, 23.0, 43.0, 85.0, 62.0, 6.0, 25.0, 61.0, 32.0, 36.0, 10.0, 1.0, 8.0, 31.0, 23.0, 8.0, 18.0, 13.0, 86.0, 77.0, 15.0, 25.0, 84.0, 18.0, 21.0, 19.0, 64.0, 78.0, 80.0, 84.0, 72.0, 62.0, 74.0, 21.0, 84.0, 70.0, 56.0, 16.0, 14.0, 16.0, 38.0, 93.0, 71.0, 27.0, 98.0, 97.0, 100.0, 86.0, 2.0, 92.0, 100.0, 99.0, 99.0, 98.0, 85.0, 94.0, 92.0, 52.0, 2.0, 1.0, 20.0, 19.0, 23.0, 70.0, 34.0, 49.0, 17.0, 70.0, 18.0, 3.0, 41.0, 11.0, 39.0, 1.0, 2.0, 72.0, 38.0, 41.0, 60.0, 78.0, 11.0, 39.0, 67.0, 46.0, 98.0, 79.0, 78.0, 38.0, 61.0, 31.0, 45.0, 40.0, 13.0, 3.0, 21.0, 9.0, 7.0, 18.0, 61.0, 33.0, 82.0, 73.0, 60.0, 81.0, 99.0, 76.0, 71.0, 100.0, 100.0, 100.0, 96.0, 95.0, 75.0, 71.0, 67.0, 43.0, 16.0, 12.0, 73.0, 11.0, 16.0, 20.0, 17.0, 6.0, 2.0, 2.0, 13.0, 8.0, 1.0, 5.0, 2.0, 41.0, 13.0, 40.0, 29.0, 1.0, 53.0, 93.0, 75.0, 7.0, 39.0, 20.0, 19.0, 26.0, 58.0, 17.0, 76.0, 13.0, 29.0, 8.0, 4.0, 7.0, 25.0, 11.0, 16.0, 6.0, 12.0, 49.0, 76.0, 87.0, 100.0, 90.0, 4.0, 4.0, 92.0, 99.0, 100.0, 100.0, 91.0, 89.0, 67.0, 52.0, 1.0, 1.0, 86.0, 70.0, 94.0, 36.0, 97.0, 2.0, 2.0, 3.0, 1.0, 1.0, 3.0, 1.0, 35.0, 39.0, 19.0, 45.0, 6.0, 9.0, 34.0, 19.0, 15.0, 18.0, 52.0, 37.0, 45.0, 53.0, 66.0, 3.0, 2.0, 3.0, 13.0, 10.0, 46.0, 37.0, 43.0, 83.0, 76.0, 99.0, 100.0, 100.0, 100.0, 100.0, 100.0, 98.0, 98.0, 77.0, 8.0, 41.0, 1.0, 1.0, 1.0, 4.0, 2.0, 70.0, 88.0, 9.0, 29.0, 2.0, 77.0, 80.0, 3.0, 6.0, 8.0, 1.0, 19.0, 8.0, 16.0, 3.0, 2.0, 4.0, 10.0, 12.0, 44.0, 33.0, 32.0, 33.0, 23.0, 67.0, 62.0, 13.0, 30.0, 38.0, 34.0, 7.0, 2.0, 1.0, 9.0, 34.0, 16.0, 13.0, 32.0, 18.0, 5.0, 4.0, 9.0, 7.0, 96.0, 96.0, 61.0, 82.0, 84.0, 13.0, 50.0, 43.0, 4.0, 83.0, 38.0, 69.0, 82.0, 96.0, 80.0, 100.0, 98.0, 1.0, 3.0, 4.0, 84.0, 31.0, 80.0, 11.0, 3.0, 33.0, 4.0, 1.0, 10.0, 8.0, 15.0, 19.0, 62.0, 77.0, 79.0, 89.0, 66.0, 40.0, 62.0, 24.0, 18.0, 18.0, 4.0, 2.0, 8.0, 3.0, 1.0, 2.0, 16.0, 23.0, 49.0, 6.0, 1.0, 2.0, 1.0, 2.0, 97.0, 54.0, 92.0, 16.0, 22.0, 5.0, 2.0, 1.0, 3.0, 2.0, 2.0, 1.0, 42.0, 1.0, 13.0, 98.0, 88.0, 98.0, 99.0, 3.0, 1.0, 51.0, 2.0, 3.0, 61.0, 11.0, 2.0, 6.0, 2.0, 7.0, 1.0, 18.0, 1.0, 1.0, 2.0, 5.0, 2.0, 87.0, 99.0, 75.0, 86.0, 66.0, 29.0, 21.0, 18.0, 3.0, 2.0, 1.0, 13.0, 1.0, 54.0, 6.0, 1.0, 9.0, 4.0, 17.0, 88.0, 77.0, 73.0, 62.0, 31.0, 3.0, 52.0, 2.0, 1.0, 5.0, 14.0, 4.0, 1.0, 97.0, 14.0, 2.0, 2.0, 1.0, 11.0, 13.0, 12.0, 19.0, 51.0, 54.0, 24.0, 2.0, 2.0, 26.0, 29.0, 3.0, 27.0, 1.0, 3.0, 3.0, 9.0, 33.0, 17.0, 5.0, 16.0, 23.0, 20.0, 19.0, 17.0, 10.0, 2.0, 3.0, 4.0, 6.0, 1.0, 1.0, 12.0, 58.0, 6.0, 77.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 61.0, 87.0, 63.0, 67.0, 1.0, 1.0, 1.0, 9.0, 10.0, 12.0, 22.0, 8.0, 45.0, 1.0, 20.0, 4.0, 22.0, 1.0, 3.0, 16.0, 18.0, 6.0, 2.0, 1.0, 4.0, 1.0, 42.0, 7.0, 2.0, 25.0, 3.0, 3.0, 1.0, 2.0, 1.0, 5.0, 1.0, 82.0, 3.0, 1.0, 1.0, 1.0, 1.0, 78.0, 24.0, 12.0, 13.0, 73.0, 1.0, 95.0, 9.0, 52.0, 55.0, 15.0, 40.0, 43.0, 27.0, 5.0, 1.0, 4.0, 2.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 15.0, 13.0, 1.0, 22.0, 16.0, 8.0, 4.0, 8.0, 1.0, 2.0, 3.0, 25.0, 67.0, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 90.0, 99.0, 41.0, 45.0, 40.0, 99.0, 82.0, 87.0, 99.0, 98.0, 51.0, 53.0, 13.0, 41.0, 29.0, 11.0, 11.0, 12.0, 2.0, 1.0, 7.0, 7.0, 2.0, 7.0, 1.0, 6.0, 2.0, 13.0, 29.0, 1.0, 11.0, 6.0, 24.0, 10.0, 4.0, 3.0, 1.0, 41.0, 37.0, 9.0, 1.0, 1.0, 1.0, 96.0, 76.0, 100.0, 99.0, 100.0, 21.0, 19.0, 15.0, 100.0, 100.0, 100.0, 9.0, 4.0, 22.0, 7.0, 8.0, 1.0, 1.0, 7.0, 7.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 3.0, 3.0, 5.0, 2.0, 1.0, 6.0, 2.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 96.0, 97.0, 92.0, 90.0, 15.0, 13.0, 14.0, 6.0, 79.0, 94.0, 95.0, 90.0, 67.0, 86.0, 21.0, 3.0, 3.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 9.0, 2.0, 1.0, 1.0, 1.0, 1.0, 15.0, 4.0, 1.0, 3.0, 3.0, 3.0, 1.0, 1.0, 6.0, 5.0, 6.0, 1.0, 9.0, 1.0, 2.0, 1.0, 93.0, 95.0, 97.0, 7.0, 9.0, 12.0, 11.0, 2.0, 8.0, 9.0, 7.0, 36.0, 25.0, 1.0, 4.0, 2.0, 1.0, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 7.0, 1.0, 1.0, 6.0, 7.0, 3.0, 1.0, 98.0, 100.0, 11.0, 13.0, 14.0, 9.0, 2.0, 1.0, 1.0, 1.0, 37.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 4.0, 1.0, 1.0, 11.0, 1.0, 98.0, 88.0, 92.0, 94.0, 63.0, 5.0, 6.0, 21.0, 9.0, 5.0, 5.0, 2.0, 10.0, 10.0, 9.0, 9.0, 55.0, 7.0, 6.0, 6.0, 4.0, 50.0, 1.0, 2.0, 1.0, 1.0, 3.0, 3.0, 95.0, 52.0, 71.0, 76.0, 73.0, 86.0, 81.0, 88.0, 51.0, 53.0, 6.0, 1.0, 18.0, 62.0, 2.0, 57.0, 56.0, 65.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0, 7.0, 3.0, 38.0, 1.0, 74.0, 85.0, 40.0, 53.0, 97.0, 79.0, 80.0, 91.0, 94.0, 95.0, 94.0, 76.0, 1.0, 93.0, 5.0, 72.0, 86.0, 85.0, 30.0, 13.0, 4.0, 1.0, 1.0, 47.0, 1.0, 9.0, 5.0, 8.0, 1.0, 1.0, 72.0, 78.0, 98.0, 99.0, 100.0, 100.0, 90.0, 86.0, 93.0, 98.0, 99.0, 100.0, 65.0, 94.0, 94.0, 94.0, 59.0, 94.0, 36.0, 6.0, 3.0, 68.0, 66.0, 16.0, 13.0, 1.0, 6.0, 5.0, 48.0, 3.0, 1.0, 62.0, 87.0, 84.0, 98.0, 43.0, 45.0, 100.0, 7.0, 2.0, 95.0, 99.0, 98.0, 67.0, 93.0, 87.0, 94.0, 96.0, 97.0, 98.0, 99.0, 99.0, 97.0, 97.0, 4.0, 2.0, 28.0, 3.0, 3.0, 3.0, 2.0, 3.0, 2.0, 1.0, 7.0, 1.0, 92.0, 98.0, 100.0, 87.0, 11.0, 58.0, 5.0, 6.0, 2.0, 63.0, 2.0, 2.0, 5.0, 1.0, 1.0, 31.0, 21.0, 97.0, 100.0, 98.0, 98.0, 95.0, 90.0, 92.0, 1.0, 1.0, 1.0, 83.0, 81.0, 3.0, 15.0, 30.0, 5.0, 95.0, 96.0, 76.0, 67.0, 27.0, 13.0, 99.0, 7.0, 86.0, 23.0, 4.0, 1.0, 1.0, 1.0, 24.0, 77.0, 100.0, 99.0, 99.0, 94.0, 98.0, 95.0, 5.0, 2.0, 9.0, 90.0, 4.0, 2.0, 1.0, 1.0, 93.0, 98.0, 87.0, 49.0, 56.0, 60.0, 62.0, 84.0, 5.0, 26.0, 16.0, 1.0, 29.0, 3.0, 2.0, 47.0, 79.0, 51.0, 97.0, 68.0, 99.0, 97.0, 99.0, 95.0, 96.0, 96.0, 4.0, 2.0, 7.0, 93.0, 1.0, 59.0, 1.0, 2.0, 19.0, 16.0, 8.0, 8.0, 8.0, 25.0, 46.0, 4.0, 21.0, 1.0, 2.0, 2.0, 22.0, 24.0, 17.0, 12.0, 85.0, 9.0, 8.0, 21.0, 1.0, 1.0, 2.0, 49.0, 33.0, 21.0, 30.0, 2.0, 2.0, 10.0, 7.0, 11.0, 1.0, 18.0, 8.0, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 24.0, 1.0, 45.0, 31.0, 30.0, 75.0, 3.0, 1.0, 70.0, 1.0, 1.0, 1.0, 1.0, 6.0, 7.0, 1.0, 3.0, 6.0, 2.0, 3.0, 1.0, 9.0, 1.0, 1.0, 5.0, 3.0, 3.0, 6.0, 17.0, 2.0, 4.0, 6.0, 1.0, 1.0, 5.0, 1.0, 6.0, 1.0, 4.0, 1.0, 2.0, 13.0, 1.0, 1.0, 3.0, 4.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 99.0, 34.0, 2.0, 1.0, 1.0, 92.0, 3.0, 1.0, 36.0, 1.0, 99.0, 98.0, 97.0, 55.0, 3.0, 1.0, 98.0, 93.0, 44.0, 11.0, 95.0, 5.0, 67.0, 2.0, 8.0, 87.0, 86.0, 89.0, 1.0, 2.0, 5.0, 3.0, 1.0, 12.0, 1.0, 2.0, 97.0, 6.0, 6.0, 58.0, 1.0, 30.0, 1.0, 1.0, 8.0, 88.0, 6.0, 12.0, 4.0, 6.0, 2.0};
        double[] s = new double[23040000];
        Arrays.fill(s, 0.0);
        for (int i = 0; i < 282; i++) {
            s[i] = 255.0;
        }
        System.arraycopy(doubles, 0, s, 282, doubles.length);
        System.out.println(new ModisGridMapper().getErrorPerPixel(s, 0, 0));
    }

    @Test
    public void name5() throws IOException {
        String[] strings = {"334 39", "335 39", "336 39", "337 39", "338 39", "339 39", "340 39", "341 39", "342 39", "343 39", "344 39", "345 39", "346 39", "347 39", "348 39", "349 39", "350 39", "351 39", "352 39", "353 39", "354 39", "355 39", "356 39", "357 39", "358 39", "334 40", "335 40", "336 40", "337 40", "338 40", "339 40", "340 40", "341 40", "342 40", "343 40", "344 40", "345 40", "346 40", "347 40", "348 40", "349 40", "350 40", "351 40", "352 40", "353 40", "354 40", "355 40", "356 40", "357 40", "358 40", "196 77", "197 77", "198 77", "199 77", "200 77", "201 77", "202 77", "203 77", "204 77", "205 77", "206 77", "207 77", "208 77", "209 77", "210 77", "211 77", "212 77", "213 77", "214 77", "215 77", "216 77", "217 77", "218 77", "219 77", "220 77", "221 77", "222 77", "196 78", "197 78", "198 78", "199 78", "200 78", "201 78", "202 78", "203 78", "204 78", "205 78", "206 78", "207 78", "208 78", "209 78", "210 78", "211 78", "212 78", "213 78", "214 78", "215 78", "216 78", "217 78", "218 78", "219 78", "220 78", "221 78", "222 78", "196 79", "197 79", "198 79", "199 79", "200 79", "201 79", "202 79", "203 79", "204 79", "205 79", "206 79", "207 79", "208 79", "209 79", "210 79", "211 79", "212 79", "213 79", "214 79", "215 79", "216 79", "217 79", "218 79", "219 79", "220 79", "221 79", "222 79", "1082 34", "1083 34", "1084 34", "1085 34", "1086 34", "1087 34", "1088 34", "1089 34", "1090 34", "1091 34", "1092 34", "1093 34", "1094 34", "1095 34", "1096 34", "1097 34", "1098 34", "1099 34", "1100 34", "1101 34", "1102 34", "1103 34", "1104 34", "1105 34", "1106 34", "1107 34", "1108 34", "1109 34", "1110 34", "1111 34", "1112 34", "1113 34", "1114 34", "1115 34", "1116 34", "1117 34", "1118 34", "1082 35", "1083 35", "1084 35", "1085 35", "1086 35", "1087 35", "1088 35", "1089 35", "1090 35", "1091 35", "1092 35", "1093 35", "1094 35", "1095 35", "1096 35", "1097 35", "1098 35", "1099 35", "1100 35", "1101 35", "1102 35", "1103 35", "1104 35", "1105 35", "1106 35", "1107 35", "1108 35", "1109 35", "1110 35", "1111 35", "1112 35", "1113 35", "1114 35", "1115 35", "1116 35", "1117 35", "1118 35", "1082 36", "1083 36", "1084 36", "1085 36", "1086 36", "1087 36", "1088 36", "1089 36", "1090 36", "1091 36", "1092 36", "1093 36", "1094 36", "1095 36", "1096 36", "1097 36", "1098 36", "1099 36", "1100 36", "1101 36", "1102 36", "1103 36", "1104 36", "1105 36", "1106 36", "1107 36", "1108 36", "1109 36", "1110 36", "1111 36", "1112 36", "1113 36", "1114 36", "1115 36", "1116 36", "1117 36", "1118 36", "1082 37", "1083 37", "1084 37", "1085 37", "1086 37", "1087 37", "1088 37", "1089 37", "1090 37", "1091 37", "1092 37", "1093 37", "1094 37", "1095 37", "1096 37", "1097 37", "1098 37", "1099 37", "1100 37", "1101 37", "1102 37", "1103 37", "1104 37", "1105 37", "1106 37", "1107 37", "1108 37", "1109 37", "1110 37", "1111 37", "1112 37", "1113 37", "1114 37", "1115 37", "1116 37", "1117 37", "1118 37", "1082 38", "1083 38", "1084 38", "1085 38", "1086 38", "1087 38", "1088 38", "1089 38", "1090 38", "1091 38", "1092 38", "1093 38", "1094 38", "1095 38", "1096 38", "1097 38", "1098 38", "1099 38", "1100 38", "1101 38", "1102 38", "1103 38", "1104 38", "1105 38", "1106 38", "1107 38", "1108 38", "1109 38", "1110 38", "1111 38", "1112 38", "1113 38", "1114 38", "1115 38", "1116 38", "1117 38", "1118 38", "1082 39", "1083 39", "1084 39", "1085 39", "1086 39", "1087 39", "1088 39", "1089 39", "1090 39", "1091 39", "1092 39", "1093 39", "1094 39", "1095 39", "1096 39", "1097 39", "1098 39", "1099 39", "1100 39", "1101 39", "1102 39", "1103 39", "1104 39", "1105 39", "1106 39", "1107 39", "1108 39", "1109 39", "1110 39", "1111 39", "1112 39", "1113 39", "1114 39", "1115 39", "1116 39", "1117 39", "1118 39"};
        try (ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("broken_pixels_7.array"))) {
            oos.writeObject(strings);
        } catch (IOException e) {
            throw e;
        }

        try (ObjectInputStream ois = new ObjectInputStream(new FileInputStream("D:\\workspace\\fire-cci\\calvalus2\\calvalus-processing\\src\\main\\resources\\com\\bc\\calvalus\\processing\\fire\\format\\grid\\modis\\broken_pixels_7.array"))) {
            String[] o = (String[]) ois.readObject();
            assertArrayEquals(strings, o);
        } catch (ClassNotFoundException e) {
            throw new IOException(e);
        }

    }
}