# switch from DHCP to a static IP address
# edit "/etc/network/interfaces"
# replace "dhcp" with "static and# add the following lines:
      address 10.3.0.XXX  ## here use the correct IP address
      gateway 10.3.0.1
      netmask 255.255.255.0


#!!! changes from 2011-10-26: netmask is now 255.255.0.0


# Fix the "/etc/hots" entry to enable correct binding and name lookup
# see http://ria101.wordpress.com/2010/01/28/setup-hbase-in-pseudo-distributed-mode-and-connect-java-client/

# get IP address from /etc/network/interfaces
grep address  /etc/network/interfaces

# replace "127.0.1.1" in "/etc/hosts" with this address
sudo pico /etc/hosts
---
x=`cat /etc/network/interfaces | awk '/address/ { print $2 }'`
mv /etc/hosts /etc/hosts~
cat /etc/hosts~ | sed -e "s/127.0.1.1/$x/" > /etc/hosts
cat /etc/hosts
---

# make sure that the second DNS server in "/etc/resolv.conf" is 10.3.0.3
---
scp hadoop@master00:/etc/resolv.conf /etc/resolv.conf.new
mv /etc/resolv.conf /etc/resolv.conf~
mv /etc/resolv.conf.new /etc/resolv.conf
cat /etc/resolv.conf
--

# in "/etc/nsswitch.conf" alter the "host:" line
# "dns" should become the second entry
---
scp hadoop@master00:/etc/nsswitch.conf /etc/nsswitch.conf.new
hadoop4u
mv /etc/nsswitch.conf /etc/nsswitch.conf~
mv /etc/nsswitch.conf.new /etc/nsswitch.conf
cat /etc/nsswitch.conf
--
=========================================================
# copy configuration from the master first, then ...
# install alternative for the configuration
sudo update-alternatives --install /etc/hadoop-0.20/conf hadoop-0.20-conf /home/hadoop/conf 90

# create hadoop specific directories (as user hadoop)
mkdir -p /home/hadoop/dfs/name
mkdir -p /home/hadoop/dfs/data
mkdir -p /hd1/hadoop/dfs/data
mkdir -p /hd2/hadoop/dfs/data
mkdir -p /home/hadoop/dfs/checkpoint
mkdir -p /home/hadoop/mapred/local
mkdir -p /hd1/hadoop/mapred/local
mkdir -p /hd2/hadoop/mapred/local
mkdir -p /home/hadoop/mapred/temp

# if directories have been created as rooot, change the ownership
chown hadoop:hadoop -R  /home/hadoop/
chown hadoop:hadoop -R  /hd1/hadoop/
chown hadoop:hadoop -R  /hd2/hadoop/

