#!/bin/bash

if [ "$1" == "" -o "$2" == "" ]
then
    echo "transfers products to HDFS"
    echo "usage  : $0 <source-dir> <format>"
    echo "example: $0 /data/hadoop/samples/MERIS-RR-2010-08 lineinterleaved"
    echo "creates dir hdfs://cvmaster00:9000/data/experiments/lineinterleaved/MERIS-RR-2010-08/*"
    exit 1
fi

sourceDir=$1
format=$2
sourceName=`basename ${sourceDir}`
targetUrl=hdfs://cvmaster00:9000/data/experiments/${format}/${sourceName}
now=`date '+%Y-%m-%dT%H:%M:%S'`

hadoop --config ~/hpc/conf fs -rmr ${targetUrl}

time hadoop --config ~/hpc/conf jar target/calvalus-experiments-0.1-SNAPSHOT-job.jar com.bc.calvalus.experiments.transfer.TransferTool ${sourceDir} ${targetUrl} ${format} > transfer-${sourceName}-${format}-${now}.tmp 2>&1

echo transfer-${sourceName}-${format}-${now}.tmp
